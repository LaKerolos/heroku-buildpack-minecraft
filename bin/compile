#!/bin/sh
set -eu

indent() {
  sed -u 's/^/       /'
}

BP_DIR="$(cd "$(dirname "$0")" && pwd)"
BUILD_DIR=$1
CACHE_DIR=$2

echo -n "-----> Installing ngrok... "
curl --silent -o ngrok.zip -L "https://bin.equinox.io/c/4VmDzA7iaHb/ngrok-stable-linux-amd64.zip" | indent
unzip ngrok.zip -d $BUILD_DIR/bin > /dev/null 2>&1
echo "done"

#minecraft_version=${MINECRAFT_VERSION:-"1.13.2"}

#if echo "$minecraft_version" | grep -q '^1\.13.*$'; then
#  minecraft_uuid="${MINECRAFT_UUID:="d0caafb8438ebd206f99930cfaecfa6c9a13dca0"}"
#  minecraft_url="https://launcher.mojang.com/mc/game/${minecraft_version}/server/${minecraft_uuid}/server.jar"
#elif echo "$minecraft_version" | grep -q '^1\.14.*$'; then
#  minecraft_uuid="${MINECRAFT_UUID:="d0d0fe2b1dc6ab4c65554cb734270872b72dadd6"}"
#  minecraft_url="https://launcher.mojang.com/v1/objects/${minecraft_uuid}/server.jar"
#else
#  minecraft_url="https://s3.amazonaws.com/Minecraft.Download/versions/${minecraft_version}/minecraft_server.${minecraft_version}.jar"
#fi

echo -n "-----> Installing Minecraft 1.14.4... "
#curl -o minecraft.jar -s -L $minecraft_url
#curl -o minecraft.jar -s -L https://launcher.mojang.com/v1/objects/3dc3d84a581f14691199cf6831b71ed1296a9fdf/server.jar
curl -o minecraft.jar -s -L https://launcher.mojang.com/v1/objects/3737db93722a9e39eeada7c27e7aca28b144ffa7/server.jar
mv minecraft.jar $BUILD_DIR/server.jar
echo "done"
